{% extends "base.html" %}
{% block content %}

<div class="container py-4">
 
  <h2 class="mb-4 text-center">Resources</h2>

  <!-- TOP TABS -->
  <ul class="nav nav-tabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="books-tab" data-bs-toggle="tab" data-bs-target="#books" type="button" role="tab">
        Books
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="phonics-tab" data-bs-toggle="tab" data-bs-target="#phonics" type="button" role="tab">
        Phonics Entry
      </button>
    </li>
  </ul>

  <!-- TAB CONTENT -->
  <div class="tab-content mt-4">

    <!-- BOOKS TAB -->
    <div class="tab-pane fade show active" id="books" role="tabpanel" aria-labelledby="books-tab">
      
      <!-- LEVEL TABS -->
      <ul class="nav nav-tabs mt-3" role="tablist">
        {% for lvl in level_tabs %}
        <li class="nav-item" role="presentation">
          <button class="nav-link {% if loop.first %}active{% endif %}" data-bs-toggle="tab" data-bs-target="#level-{{ lvl | replace(' ','_') | lower }}">
            {{ lvl }}
          </button>
        </li>
        {% endfor %}
      </ul>

      <!-- LEVEL CONTENT -->
      <div class="tab-content mt-3">
        {% set categories = ['Story','Words','Workout','Comprehension','Test'] %}
        {% for lvl in level_tabs %}
          <div class="tab-pane fade {% if loop.first %}show active{% endif %}" id="level-{{ lvl | replace(' ','_') | lower }}">
            {% for cat in categories %}
              {% set cat_books = [] %}
              {% for b in books_by_level[lvl] %}
                {% if (b.category or '')|lower == cat|lower %}
                  {% set _ = cat_books.append(b) %}
                {% endif %}
              {% endfor %}

              {% if cat_books %}
                <h5 class="mt-3">{{ cat }}</h5>
                <div class="d-flex flex-wrap">
                  {% for b in cat_books %}
                    <div class="card p-3 m-2" style="min-width: 180px; box-shadow: 0 2px 5px rgba(0,0,0,0.08);">
                      <strong>{{ b.original_name }}</strong><br>
                      <small>Level: {{ b.levels }}</small><br>
                      <a href="{{ url_for('view_book', book_id=b.id) }}" class="btn btn-sm btn-primary mt-2">View</a>
                    </div>
                  {% endfor %}
                </div>
              {% endif %}
            {% endfor %}
          </div>
        {% endfor %}
      </div>
    </div>

    <!-- PHONICS TAB -->
    <div class="tab-pane fade" id="phonics" role="tabpanel" aria-labelledby="phonics-tab">
      <div class="card p-4 mb-4">

        <h4>üóìÔ∏è Enter Phonics Record</h4>
        <form method="POST" action="{{ url_for('teacher_phonics') }}" id="phonicsForm">
          <div class="mb-3">
            <label>Date</label>
            <input type="date" name="date" class="form-control" required>
          </div>

          <div class="mb-3">
            <label>Student Name</label>
            <input type="text" name="student_name" class="form-control" required>
          </div>

          <div class="mb-3">
            <label>Level</label>
            <select name="level" id="levelSelect" class="form-select" required>
              <option value="" disabled selected>Select Level</option>
              {% for lvl in level_tabs %}
                <option value="{{ lvl }}">{{ lvl }}</option>
              {% endfor %}
            </select>
          </div>

      <label class="mt-3">Book Name</label>
<select name="book_name" id="book_name" class="form-select" required>
  <option value="" disabled selected>-- Select Book --</option>

  <!-- Level 1 -->
  <option value="Snap" data-level="1">Snap</option>
  <option value="Picnic" data-level="1">Picnic</option>
  <option value="Mud" data-level="1">Mud</option>
  <option value="Animals" data-level="1">Animals</option>

  <!-- Level 2 -->
  <option value="Dot" data-level="2">Dot</option>
  <option value="Tap" data-level="2">Tap</option>
  <option value="Big Pig" data-level="2">Big Pig</option>
  <option value="Jam" data-level="2">Jam</option>

  <!-- Level 3 -->
  <option value="A Pet Dog" data-level="3">A Pet Dog</option>
  <option value="Ten Men" data-level="3">Ten Men</option>
  <option value="The Fox" data-level="3">The Fox</option>
  <option value="A Vet" data-level="3">A Vet</option>

  <!-- Level 4 -->
  <option value="Quick Run" data-level="4">Quick Run</option>
  <option value="A Long Day" data-level="4">A Long Day</option>
  <option value="A Fun Trip" data-level="4">A Fun Trip</option>
  <option value="A Short Walk" data-level="4">A Short Walk</option>

  <!-- Level 5 -->
  <option value="The Best Gift" data-level="5">The Best Gift</option>
  <option value="A New Toy" data-level="5">A New Toy</option>
  <option value="Rainy Day" data-level="5">Rainy Day</option>
  <option value="At The Zoo" data-level="5">At The Zoo</option>

  <!-- Level 6 -->
  <option value="The Lost Ball" data-level="6">The Lost Ball</option>
  <option value="The Little Plant" data-level="6">The Little Plant</option>
  <option value="The Tall Tree" data-level="6">The Tall Tree</option>
  <option value="The Swing" data-level="6">The Swing</option>

  <!-- Level 7 -->
  <option value="My New Friend" data-level="7">My New Friend</option>
  <option value="The Boat Trip" data-level="7">The Boat Trip</option>
  <option value="The Brave Kid" data-level="7">The Brave Kid</option>
  <option value="The Clever Fox" data-level="7">The Clever Fox</option>

  <!-- Red -->
  <option value="Mud" data-level="Red">Mud</option>
  <option value="Inky" data-level="Red">Inky</option>
  <option value="Zack" data-level="Red">Zack</option>
  <option value="Snake" data-level="Red">Snake</option>
  <option value="Monster Footsteps" data-level="Red">Monster Footsteps</option>
  <option value="Moat Farm" data-level="Red">Moat Farm</option>
  <option value="The Rocket" data-level="Red">The Rocket</option>
  <option value="Monsters" data-level="Red">Monsters</option>
  <option value="The Pond" data-level="Red">The Pond</option>
  <option value="Helping" data-level="Red">Helping</option>
  <option value="The Wind and the Sun" data-level="Red">The Wind and the Sun</option>
  <option value="Star and Fish" data-level="Red">Star and Fish</option>
  <option value="A Dog Has Pups" data-level="Red">A Dog Has Pups</option>
  <option value="A Shoal of Fish" data-level="Red">A Shoal of Fish</option>
  <option value="Slugs and Snails" data-level="Red">Slugs and Snails</option>
  <option value="Foxes" data-level="Red">Foxes</option>
  <option value="Insects" data-level="Red">Insects</option>
  <option value="Book Week" data-level="Red">Book Week</option>

  <!-- Yellow -->
  <option value="Phonic" data-level="Yellow">Phonic</option>
  <option value="Hetty" data-level="Yellow">Hetty</option>
  <option value="Zack‚Äôs Present" data-level="Yellow">Zack‚Äôs Present</option>
  <option value="Picnic" data-level="Yellow">Picnic</option>
  <option value="Spots" data-level="Yellow">Spots</option>
  <option value="Looking for Snake" data-level="Yellow">Looking for Snake</option>
  <option value="Monster Party" data-level="Yellow">Monster Party</option>
  <option value="Red Hen" data-level="Yellow">Red Hen</option>
  <option value="The Box" data-level="Yellow">The Box</option>
  <option value="Swimming" data-level="Yellow">Swimming</option>
  <option value="Crabs" data-level="Yellow">Crabs</option>
  <option value="Animal Chatter" data-level="Yellow">Animal Chatter</option>
  <option value="Rainforests" data-level="Yellow">Rainforests</option>
  <option value="Cheese Stars" data-level="Yellow">Cheese Stars</option>
  <option value="Oil" data-level="Yellow">Oil</option>
  <option value="Lizards" data-level="Yellow">Lizards</option>
  <option value="Shells" data-level="Yellow">Shells</option>
  <option value="Butterflies and Moths" data-level="Yellow">Butterflies and Moths</option>

  <!-- Green -->
  <option value="The Tree That Blinked" data-level="Green">The Tree That Blinked</option>
  <option value="What‚Äôs in the Box?" data-level="Green">What‚Äôs in the Box?</option>
  <option value="The Old Red Tractor" data-level="Green">The Old Red Tractor</option>
  <option value="The Model Boat" data-level="Green">The Model Boat</option>
  <option value="Wait and See!" data-level="Green">Wait and See!</option>
  <option value="The Bad-Tempered Goat" data-level="Green">The Bad-Tempered Goat</option>
  <option value="The Three Billy Goats Gruff" data-level="Green">The Three Billy Goats Gruff</option>
  <option value="The Fox and the Stork" data-level="Green">The Fox and the Stork</option>
  <option value="The Outing" data-level="Green">The Outing</option>
  <option value="The Little Merman" data-level="Green">The Little Merman</option>
  <option value="The Cricket and the Ants" data-level="Green">The Cricket and the Ants</option>
  <option value="Little Monsters" data-level="Green">Little Monsters</option>
  <option value="Snakes" data-level="Green">Snakes</option>
  <option value="Deserts" data-level="Green">Deserts</option>
  <option value="Captain Scott" data-level="Green">Captain Scott</option>
  <option value="Underground" data-level="Green">Underground</option>
  <option value="Mushrooms" data-level="Green">Mushrooms</option>
  <option value="Teeth" data-level="Green">Teeth</option>

  <!-- Blue -->
  <option value="The Bird House" data-level="Blue">The Bird House</option>
  <option value="Daisy and Buttercup" data-level="Blue">Daisy and Buttercup</option>
  <option value="The New Kitten" data-level="Blue">The New Kitten</option>
  <option value="An Inter-Hive Match" data-level="Blue">An Inter-Hive Match</option>
  <option value="The Maize Maze" data-level="Blue">The Maize Maze</option>
  <option value="Beach Rescue" data-level="Blue">Beach Rescue</option>
  <option value="The Enormous Turnip" data-level="Blue">The Enormous Turnip</option>
  <option value="Rumpelstiltskin" data-level="Blue">Rumpelstiltskin</option>
  <option value="Puppets" data-level="Blue">Puppets</option>
  <option value="Many More Monsters" data-level="Blue">Many More Monsters</option>
  <option value="The Pumpkin Party" data-level="Blue">The Pumpkin Party</option>
  <option value="Soccer" data-level="Blue">Soccer</option>
  <option value="Mountains" data-level="Blue">Mountains</option>
  <option value="Henry Ford" data-level="Blue">Henry Ford</option>
  <option value="Sharks" data-level="Blue">Sharks</option>
  <option value="The Moon" data-level="Blue">The Moon</option>
  <option value="Town Mouse and Country Mouse" data-level="Blue">Town Mouse and Country Mouse</option>
  <option value="The Nile" data-level="Blue">The Nile</option>
</select>


          <div class="mb-3">
            <label>Time Taken (in minutes)</label>
            <input type="number" name="time_taken" class="form-control" required>
          </div>

          <div class="mb-3">
            <label>Feedback</label>
            <textarea name="feedback" class="form-control" rows="3"></textarea>
          </div>

          <button type="submit" class="btn btn-success w-100">Submit Record</button>
        </form>
      </div>

      <!-- Submitted Entries -->
      <div class="card p-4">
        <h5 class="mb-3">üìö Your Submitted Entries</h5>
        {% if entries %}
          <div class="d-flex flex-wrap">
            {% for entry in entries %}
              <div class="card p-3 m-2" style="min-width: 220px; box-shadow: 0 2px 5px rgba(0,0,0,0.08);">
                <strong>{{ entry.student_name }}</strong><br>
                <small>Date: {{ entry.date }}</small><br>
                <small>Level: {{ entry.level }}</small><br>
                <small>Book: {{ entry.book_name }}</small><br>
                <small>Time Taken: {{ entry.time_taken }} min</small><br>
                <p>Feedback: {{ entry.feedback or '-' }}</p>
              </div>
            {% endfor %}
          </div>
        {% else %}
          <p>No phonics entries found.</p>
        {% endif %}
      </div>

    </div>

  </div>

</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const levelSelect = document.getElementById('level');
    const bookSelect = document.getElementById('book_name');

    function filterBooks() {
        const selectedLevel = levelSelect.value;

        Array.from(bookSelect.options).forEach(option => {
            if (!option.dataset.level) return;

            if (option.dataset.level === selectedLevel) {
                option.style.display = '';
            } else {
                option.style.display = 'none';
            }
        });

        bookSelect.value = "";
    }

    levelSelect.addEventListener('change', filterBooks);
});
</script>


{% endblock %}

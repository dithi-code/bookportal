{% extends "teacher_dashboard.html" %}
{% block content %}

<h2 class="mb-3">ðŸ“š Phonics Entry</h2>

<div class="card p-4 shadow-sm">

    <form action="{{ url_for('add_phonics_entry') }}" method="POST">

        <!-- Date -->
        <label class="mt-2">Date</label>
        <input type="date" name="date" class="form-control" required>

        <!-- Student Name -->
        <label class="mt-3">Student Name</label>
        <input type="text" name="student_name" class="form-control" required>

        <!-- Level -->
        <label class="mt-3">Level</label>
        <select name="level" class="form-select" id="levelSelect" required>
            <option value="" selected disabled>Select Level</option>
            {% for lvl in levels %}
            <option value="{{ lvl }}">{{ lvl }}</option>
            {% endfor %}
        </select>

        <!-- Book Dropdown (Hardcoded) -->
<label class="mt-3">Book Name</label>
<select name="book_id" class="form-select" id="bookSelect" disabled required>
  <option value="">-- Select Book --</option>

            <!-- LEVEL 1 -->
            <option value="1" data-level="1">Snap</option>
            <option value="2" data-level="1">Tips</option>
            <option value="3" data-level="1">Ants</option>

            <!-- LEVEL 2 -->
            <option value="4" data-level="2">Hen and Catâ€™s Picnic</option>
            <option value="5" data-level="2">Pet Panic</option>
            <option value="6" data-level="2">Dadâ€™s Red Tent</option>

            <!-- LEVEL 3 -->
            <option value="7" data-level="3">Golf Is Not Fun</option>
            <option value="8" data-level="3">Brettâ€™s Dragon</option>
            <option value="9" data-level="3">Duck gets stuck</option>

            <!-- LEVEL 4 -->
            <option value="10" data-level="4">Just a Storm</option>
            <option value="11" data-level="4">Red Jackâ€™s Fort</option>
            <option value="12" data-level="4">Jaidenâ€™s Lies</option>

            <!-- LEVEL 5 -->
            <option value="13" data-level="5">A Hospital Visit</option>
            <option value="14" data-level="5">Seven Elves</option>
            <option value="15" data-level="5">A Pong at Oak Wood Zoo</option>

            <!-- LEVEL 6 -->
            <option value="16" data-level="6">An Omelette for Lunch</option>
            <option value="17" data-level="6">Fox Cub Stops Yelling</option>
            <option value="18" data-level="6">A Boxfish in a Rush</option>

            <!-- LEVEL 7 -->
            <option value="19" data-level="7">Spoilsport</option>
            <option value="20" data-level="7">In the Attic</option>
            <option value="21" data-level="7">Mervinâ€™s Garden</option>

            <!-- RED -->
            <option value="22" data-level="Red">Mud</option>
            <option value="23" data-level="Red">Inky</option>
            <option value="24" data-level="Red">Zack</option>
            <option value="25" data-level="Red">Snake</option>
            <option value="26" data-level="Red">Monster Footsteps</option>
            <option value="27" data-level="Red">Moat Farm</option>
            <option value="28" data-level="Red">The Rocket</option>
            <option value="29" data-level="Red">Monsters</option>
            <option value="30" data-level="Red">The Pond</option>
            <option value="31" data-level="Red">Helping</option>
            <option value="32" data-level="Red">The Wind and the Sun</option>
            <option value="33" data-level="Red">Star and Fish</option>
            <option value="34" data-level="Red">A Dog Has Pups</option>
            <option value="35" data-level="Red">A Shoal of Fish</option>
            <option value="36" data-level="Red">Slugs and Snails</option>
            <option value="37" data-level="Red">Foxes</option>
            <option value="38" data-level="Red">Insects</option>
            <option value="39" data-level="Red">Book Week</option>

            <!-- YELLOW -->
            <option value="40" data-level="Yellow">Phonic</option>
            <option value="41" data-level="Yellow">Hetty</option>
            <option value="42" data-level="Yellow">Zackâ€™s Present</option>
            <option value="43" data-level="Yellow">Picnic</option>
            <option value="44" data-level="Yellow">Spots</option>
            <option value="45" data-level="Yellow">Looking for Snake</option>
            <option value="46" data-level="Yellow">Monster Party</option>
            <option value="47" data-level="Yellow">Red Hen</option>
            <option value="48" data-level="Yellow">The Box</option>
            <option value="49" data-level="Yellow">Swimming</option>
            <option value="50" data-level="Yellow">Crabs</option>
            <option value="51" data-level="Yellow">Animal Chatter</option>
            <option value="52" data-level="Yellow">Rainforests</option>
            <option value="53" data-level="Yellow">Cheese Stars</option>
            <option value="54" data-level="Yellow">Oil</option>
            <option value="55" data-level="Yellow">Lizards</option>
            <option value="56" data-level="Yellow">Shells</option>
            <option value="57" data-level="Yellow">Butterflies and Moths</option>

            <!-- GREEN -->
            <option value="58" data-level="Green">The Tree That Blinked</option>
            <option value="59" data-level="Green">Whatâ€™s in the Box?</option>
            <option value="60" data-level="Green">The Old Red Tractor</option>
            <option value="61" data-level="Green">The Model Boat</option>
            <option value="62" data-level="Green">Wait and See!</option>
            <option value="63" data-level="Green">The Bad-Tempered Goat</option>
            <option value="64" data-level="Green">The Three Billy Goats Gruff</option>
            <option value="65" data-level="Green">The Fox and the Stork</option>
            <option value="66" data-level="Green">The Outing</option>
            <option value="67" data-level="Green">The Little Merman</option>
            <option value="68" data-level="Green">The Cricket and the Ants</option>
            <option value="69" data-level="Green">Little Monsters</option>
            <option value="70" data-level="Green">Snakes</option>
            <option value="71" data-level="Green">Deserts</option>
            <option value="72" data-level="Green">Captain Scott</option>
            <option value="73" data-level="Green">Underground</option>
            <option value="74" data-level="Green">Mushrooms</option>
            <option value="75" data-level="Green">Teeth</option>

            <!-- BLUE -->
            <option value="76" data-level="Blue">The Bird House</option>
            <option value="77" data-level="Blue">Daisy and Buttercup</option>
            <option value="78" data-level="Blue">The New Kitten</option>
            <option value="79" data-level="Blue">An Inter-Hive Match</option>
            <option value="80" data-level="Blue">The Maize Maze</option>
            <option value="81" data-level="Blue">Beach Rescue</option>
            <option value="82" data-level="Blue">The Enormous Turnip</option>
            <option value="83" data-level="Blue">Rumpelstiltskin</option>
            <option value="84" data-level="Blue">Puppets</option>
            <option value="85" data-level="Blue">Many More Monsters</option>
            <option value="86" data-level="Blue">The Pumpkin Party</option>
            <option value="87" data-level="Blue">Soccer</option>
            <option value="88" data-level="Blue">Mountains</option>
            <option value="89" data-level="Blue">Henry Ford</option>
            <option value="90" data-level="Blue">Sharks</option>
            <option value="91" data-level="Blue">The Moon</option>
            <option value="92" data-level="Blue">Town Mouse and Country Mouse</option>
            <option value="93" data-level="Blue">The Nile</option>

        </select>

        <!-- Time Taken -->
        <label class="mt-3">Time Taken (in minutes)</label>
        <input type="number" name="time_taken" min="1" class="form-control" required>

        <!-- Feedback -->
        <label class="mt-3">Feedback</label>
        <textarea name="feedback" rows="3" class="form-control"></textarea>

        <button class="btn btn-success mt-4">Submit Entry</button>
    </form>
</div>

<hr class="my-4">

<h4>Saved Entries</h4>

{% if entries %}
<div class="list-group">
    {% for e in entries %}
    <div class="list-group-item">
        <strong>{{ e.student_name }}</strong>
        <span class="badge bg-info ms-2">{{ e.level }}</span>

        <p class="mt-2"><b>Book:</b> {{ e.book.original_name if e.book else 'N/A' }}</p>
        <p><b>Date:</b> {{ e.date }}</p>
        <p><b>Time:</b> {{ e.time_taken }} mins</p>
        <p><b>Feedback:</b> {{ e.feedback }}</p>

        <form method="POST"
              action="{{ url_for('delete_phonics_entry', pid=e.id) }}"
              onsubmit="return confirm('Delete this entry?');">
            <button class="btn btn-danger btn-sm">Delete</button>
        </form>
    </div>
    {% endfor %}
</div>
{% else %}
<p>No phonics entries added yet.</p>
{% endif %}

<!-- JS: Filter books by level -->
<script>
const levelSelect = document.getElementById("levelSelect");
const bookSelect = document.getElementById("bookSelect");

levelSelect.addEventListener("change", () => {
    const selected = levelSelect.value;

    bookSelect.disabled = false;

    for (let opt of bookSelect.options) {
        if (opt.value === "" || opt.dataset.level === selected) {
            opt.style.display = "";
        } else {
            opt.style.display = "none";
        }
    }

    bookSelect.value = "";
});
</script>

{% endblock %}
